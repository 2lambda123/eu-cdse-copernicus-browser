import { hasCCMDownloadAccess, isProductCCM, shouldShowCCMAccessError } from './ProductInfo.utils';

const userTokenWithCCMAccessRole =
  'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJYVUh3VWZKaHVDVWo0X3k4ZF8xM0hxWXBYMFdwdDd2anhob2FPLUxzREZFIn0.eyJleHAiOjE3MTM0NDY0ODEsImlhdCI6MTcxMzQ0NTU4MSwiYXV0aF90aW1lIjoxNzEzNDI1MDE4LCJqdGkiOiJlMDAzMmQ4Ni1hOTFiLTRhN2MtYjE2My1jMTljMmFlYjhhOGQiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LmRhdGFzcGFjZS5jb3Blcm5pY3VzLmV1L2F1dGgvcmVhbG1zL0NEU0UiLCJhdWQiOlsiQ0xPVURGRVJST19QVUJMSUMiLCJhY2NvdW50Il0sInN1YiI6ImMwNTM2MGQ4LWYwZDQtNGQ5Mi1hYWRhLTk4YjZjN2U1MGRmNSIsInR5cCI6IkJlYXJlciIsImF6cCI6InNoLWQzMWE4ZDk2LWFiMjgtNDI0OS1hMjNhLWFhNGY3NTQ3NTkxNiIsIm5vbmNlIjoiNDEzNzQ3MTMwOTE1NzA4MSIsInNlc3Npb25fc3RhdGUiOiIyYWRkNTFjZi1hNjQxLTQxYTYtOGI2ZC0yMDZlNDMyZWM0OTkiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsidW5pb24taW5zdC1jY20iLCJzMS1leHBlcnQiLCJzNXAtZXhwZXJ0IiwiY29wZXJuaWN1cy1zZXJ2aWNlcy1jY20iLCJ1bmlvbi1yZXNlYXJjaC1wcm9qZWN0cy1zcGFjZS1jY20iLCJzMy1leHBlcnQiLCJpbnQtb3JnLW5nby1jY20iLCJwdWJsaWMtYXV0aC1jY20iLCJ1bmlvbi1yZXNlYXJjaC1wcm9qZWN0cy1ub24tc3BhY2UtY2NtIiwib2ZmbGluZV9hY2Nlc3MiLCJjb3Blcm5pY3VzLW9wZXJhdG9ycy1jY20iLCJ1bWFfYXV0aG9yaXphdGlvbiIsInB1YmxpYy1jY20iLCJkZWZhdWx0LXJvbGVzLWNkYXMiLCJjb3Blcm5pY3VzLWdlbmVyYWwiXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6IkFVRElFTkNFX1BVQkxJQyBlbWFpbCBwcm9maWxlIHVzZXItY29udGV4dCIsInNpZCI6IjJhZGQ1MWNmLWE2NDEtNDFhNi04YjZkLTIwNmU0MzJlYzQ5OSIsImdyb3VwX21lbWJlcnNoaXAiOlsiL2FjY2Vzc19ncm91cHMvdXNlcl90eXBvbG9neS9jb3Blcm5pY3VzX2dlbmVyYWwiLCIvYWNjZXNzX2dyb3Vwcy91c2VyX3R5cG9sb2d5L2NvcGVybmljdXNfb3BlcmF0b3JzX2NjbSIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvY29wZXJuaWN1c19zZXJ2aWNlc19jY20iLCIvYWNjZXNzX2dyb3Vwcy91c2VyX3R5cG9sb2d5L2ludF9vcmdfbmdvX2NjbSIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvcHVibGljX2F1dGhfY2NtIiwiL2FjY2Vzc19ncm91cHMvdXNlcl90eXBvbG9neS9wdWJsaWNfY2NtIiwiL29yZ2FuaXphdGlvbnMvYWNjLWFmNWYxYTA4LWE3YzMtNDhiMC04MWNmLTY2MmI0NzdlOGUwMy9yZWd1bGFyX3VzZXIiLCIvYWNjZXNzX2dyb3Vwcy91c2VyX3R5cG9sb2d5L3MxX2V4cGVydCIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvczNfZXhwZXJ0IiwiL2FjY2Vzc19ncm91cHMvdXNlcl90eXBvbG9neS9zNXBfZXhwZXJ0IiwiL2FjY2Vzc19ncm91cHMvdXNlcl90eXBvbG9neS91bmlvbl9pbnN0X2NjbSIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvdW5pb25fcmVzZWFyY2hfcHJvamVjdHNfbm9uX3NwYWNlX2NjbSIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvdW5pb25fcmVzZWFyY2hfcHJvamVjdHNfc3BhY2VfY2NtIl0sImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJvcmdhbml6YXRpb25zIjpbImFjYy1hZjVmMWEwOC1hN2MzLTQ4YjAtODFjZi02NjJiNDc3ZThlMDMiXSwibmFtZSI6IkZFLVRlYW0gVGVzdCBBY2NvdW50IiwidXNlcl9jb250ZXh0X2lkIjoiYWY1ZjFhMDgtYTdjMy00OGIwLTgxY2YtNjYyYjQ3N2U4ZTAzIiwiY29udGV4dF9yb2xlcyI6e30sImNvbnRleHRfZ3JvdXBzIjpbIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvY29wZXJuaWN1c19nZW5lcmFsLyIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvY29wZXJuaWN1c19vcGVyYXRvcnNfY2NtLyIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvY29wZXJuaWN1c19zZXJ2aWNlc19jY20vIiwiL2FjY2Vzc19ncm91cHMvdXNlcl90eXBvbG9neS9pbnRfb3JnX25nb19jY20vIiwiL2FjY2Vzc19ncm91cHMvdXNlcl90eXBvbG9neS9wdWJsaWNfYXV0aF9jY20vIiwiL2FjY2Vzc19ncm91cHMvdXNlcl90eXBvbG9neS9wdWJsaWNfY2NtLyIsIi9vcmdhbml6YXRpb25zL2FjYy1hZjVmMWEwOC1hN2MzLTQ4YjAtODFjZi02NjJiNDc3ZThlMDMvcmVndWxhcl91c2VyLyIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvczFfZXhwZXJ0LyIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvczNfZXhwZXJ0LyIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvczVwX2V4cGVydC8iLCIvYWNjZXNzX2dyb3Vwcy91c2VyX3R5cG9sb2d5L3VuaW9uX2luc3RfY2NtLyIsIi9hY2Nlc3NfZ3JvdXBzL3VzZXJfdHlwb2xvZ3kvdW5pb25fcmVzZWFyY2hfcHJvamVjdHNfbm9uX3NwYWNlX2NjbS8iLCIvYWNjZXNzX2dyb3Vwcy91c2VyX3R5cG9sb2d5L3VuaW9uX3Jlc2VhcmNoX3Byb2plY3RzX3NwYWNlX2NjbS8iXSwicHJlZmVycmVkX3VzZXJuYW1lIjoidGVhbTYiLCJnaXZlbl9uYW1lIjoiRkUtVGVhbSIsInVzZXJfY29udGV4dCI6ImFjYy1hZjVmMWEwOC1hN2MzLTQ4YjAtODFjZi02NjJiNDc3ZThlMDMiLCJmYW1pbHlfbmFtZSI6IlRlc3QgQWNjb3VudCIsImVtYWlsIjoiY2Rhc19icm93c2VyQHNlbnRpbmVsLWh1Yi5jb20ifQ.R_S74ACzhLSTfO_KOTHgCBk8vYxTDKN07Y4iiuAu6BC6FQkf6V9q1hXriR56mSqS-FNl84SVLrNLlN6ydQpNhID4VecvslRippKRSq6hX54slYDz4UG0eu-n4ZnCDYNjT61V4SqUBW-cCZEBI53MNlkBEHtOwZ-P66CKjKJCka8EZjHvtV9j3OAAbvaqLyBcrWo3DrD_0zvMWY0QUmKxXemt6j2O9OQpqQJohIlcsADLIuZfDRStffxNhVPfhHl2nqCiOjvah0H-lU7FDXrHI7QB4VpRgGi6aKFRimYMIpi-NvrUo516ydBoyb_fnUNWu3tzyBdnhna177z4MCpN-w';

const userTokenWithOutCCMAccessRole =
  'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJYVUh3VWZKaHVDVWo0X3k4ZF8xM0hxWXBYMFdwdDd2anhob2FPLUxzREZFIn0.eyJleHAiOjE3MTIyNDg5NTAsImlhdCI6MTcxMjI0ODA1MCwiYXV0aF90aW1lIjoxNzEyMjM5NTA0LCJqdGkiOiIwZDNlMGFjOC00YjM4LTQ5ZmUtYjhhYy04NTM2M2VjNmEzZmIiLCJpc3MiOiJodHRwczovL2lkZW50aXR5LmRhdGFzcGFjZS5jb3Blcm5pY3VzLmV1L2F1dGgvcmVhbG1zL0NEU0UiLCJhdWQiOlsiQ0xPVURGRVJST19QVUJMSUMiLCJhY2NvdW50Il0sInN1YiI6IjdjNGU3NDZkLTE1OWUtNDIyZi05OTQ4LWViYjQ0NzhjZTA0MiIsInR5cCI6IkJlYXJlciIsImF6cCI6InNoLWQzMWE4ZDk2LWFiMjgtNDI0OS1hMjNhLWFhNGY3NTQ3NTkxNiIsIm5vbmNlIjoiNTk3Nzk3MDg4NDA4OTI3MyIsInNlc3Npb25fc3RhdGUiOiIzOTU5ZmY5My03YTM1LTQ0M2EtOGM3Yy0wMDRhMzdlNTk4YjQiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtY2RhcyIsImNvcGVybmljdXMtZ2VuZXJhbCJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiQVVESUVOQ0VfUFVCTElDIGVtYWlsIHByb2ZpbGUgdXNlci1jb250ZXh0Iiwic2lkIjoiMzk1OWZmOTMtN2EzNS00NDNhLThjN2MtMDA0YTM3ZTU5OGI0IiwiZ3JvdXBfbWVtYmVyc2hpcCI6WyIvYWNjZXNzX2dyb3Vwcy91c2VyX3R5cG9sb2d5L2NvcGVybmljdXNfZ2VuZXJhbCIsIi9vcmdhbml6YXRpb25zL2FjYy03YTJlNmQzZS04YjI2LTRiZmMtODg5OC1lYjUzNGY3NjA3OTYvcmVndWxhcl91c2VyIl0sImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJvcmdhbml6YXRpb25zIjpbImFjYy03YTJlNmQzZS04YjI2LTRiZmMtODg5OC1lYjUzNGY3NjA3OTYiXSwibmFtZSI6IlN0ZWxpb3MtRXJ2aXMgUHJpZnRpcyIsInVzZXJfY29udGV4dF9pZCI6IjdhMmU2ZDNlLThiMjYtNGJmYy04ODk4LWViNTM0Zjc2MDc5NiIsImNvbnRleHRfcm9sZXMiOnt9LCJjb250ZXh0X2dyb3VwcyI6WyIvYWNjZXNzX2dyb3Vwcy91c2VyX3R5cG9sb2d5L2NvcGVybmljdXNfZ2VuZXJhbC8iLCIvb3JnYW5pemF0aW9ucy9hY2MtN2EyZTZkM2UtOGIyNi00YmZjLTg4OTgtZWI1MzRmNzYwNzk2L3JlZ3VsYXJfdXNlci8iXSwicHJlZmVycmVkX3VzZXJuYW1lIjoic3RlbGlvcy5wcmlmdGlzQHNpbmVyZ2lzZS5jb20iLCJnaXZlbl9uYW1lIjoiU3RlbGlvcy1FcnZpcyIsInVzZXJfY29udGV4dCI6ImFjYy03YTJlNmQzZS04YjI2LTRiZmMtODg5OC1lYjUzNGY3NjA3OTYiLCJmYW1pbHlfbmFtZSI6IlByaWZ0aXMiLCJlbWFpbCI6InN0ZWxpb3MucHJpZnRpc0BzaW5lcmdpc2UuY29tIn0.GC_CxDLeguOtZRhKTWfVl-PoxbQS35DZSUKslaAIb3MVr5KV1f2HeGaw_HnGATiFAQvLBzch_bAiTut0yOZUL1Rtrhft39LQrkQIvCXRM3E0GR8P9qKMvPtTm7F9NlPtYmkCkDJ_h9xQEzVfs2SIWxdwz7uDiLLwsKTVkUEP9GzpHJaTT6BuFxMWkl_BemWPZY_QZ6GqRddFc72yZJ2JFj8VlqXv61QdK-ezCg5hU_WyfbzQhI6o3ROLJZ_T-GLyGfWyqHVYp9e7VVqRgGM2WRd089aNPc5AMoDQD26OJFRusQcL2GoC_TpXzCioCJd_Pcd2ZZj3S-ak4KM0IW4ZIA';

describe('test functions responsible for validating CCM access', () => {
  const CCMProductType1 = { productType: 'OPT_MS4_1C_B34B' };
  const CCMProductType2 = { productType: 'PHR_MS___3_54FA' };
  const NonCCMProductType1 = { productType: 'S2MSI2A' };
  const NonCCMProductType2 = { productType: 'L2__NO2___' };

  test('isProductCCM', () => {
    expect(isProductCCM(CCMProductType1)).toBeTruthy();
    expect(isProductCCM(CCMProductType2)).toBeTruthy();
    expect(isProductCCM(NonCCMProductType1)).toBeFalsy();
    expect(isProductCCM(NonCCMProductType2)).toBeFalsy();
  });

  test.each([
    [CCMProductType1.productType],
    [CCMProductType2.productType],
    ['GIS_PM4_SO_71F4'],
    ['AIS_MSP_1R_E1F0'],
    ['HRS_MS4_1C_E1F0'],
    ['HRG_THX__3_56FB'],
    ['OPT_MS4_1B_07B6'],
    ['MSI_IMG_3A_56FB'],
    ['A3D_DEM_18_7854'],
    ['WV1_PM8_SO_5558'],
    ['SAR_DGE_30_A4AD'],
    ['HRG_J____3_57BB'],
    ['HIR_I____3_7BC7'],
  ])('hasCCMDownloadAccess %p', (productType) => {
    expect(hasCCMDownloadAccess(userTokenWithCCMAccessRole, { productType })).toBeTruthy();
    expect(hasCCMDownloadAccess(userTokenWithOutCCMAccessRole, { productType })).toBeFalsy();
  });

  test.each([[NonCCMProductType1.productType], [NonCCMProductType2.productType]])(
    'hasCCMDownloadAccess %p',
    (productType) => {
      expect(hasCCMDownloadAccess(userTokenWithCCMAccessRole, { productType })).toBeFalsy();
      expect(hasCCMDownloadAccess(userTokenWithOutCCMAccessRole, { productType })).toBeFalsy();
    },
  );

  test('shouldShowCCMAccessError', () => {
    expect(shouldShowCCMAccessError(userTokenWithCCMAccessRole, CCMProductType1)).toBeFalsy();
    expect(shouldShowCCMAccessError(userTokenWithCCMAccessRole, CCMProductType2)).toBeFalsy();
    expect(shouldShowCCMAccessError(userTokenWithCCMAccessRole, NonCCMProductType1)).toBeFalsy();
    expect(shouldShowCCMAccessError(userTokenWithCCMAccessRole, NonCCMProductType2)).toBeFalsy();

    expect(shouldShowCCMAccessError(userTokenWithOutCCMAccessRole, CCMProductType1)).toBeTruthy();
    expect(shouldShowCCMAccessError(userTokenWithOutCCMAccessRole, CCMProductType2)).toBeTruthy();
    expect(shouldShowCCMAccessError(userTokenWithOutCCMAccessRole, NonCCMProductType1)).toBeFalsy();
    expect(shouldShowCCMAccessError(userTokenWithOutCCMAccessRole, NonCCMProductType2)).toBeFalsy();
  });
});
